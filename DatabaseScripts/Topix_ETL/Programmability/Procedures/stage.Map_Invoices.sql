SET QUOTED_IDENTIFIER, ANSI_NULLS ON
GO
CREATE PROC [stage].[Map_Invoices]

AS

TRUNCATE TABLE stage.Invoices

INSERT INTO stage.Invoices (
	   [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]
)

SELECT [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]		
FROM [store].[ClarityRx_Invoices]



INSERT INTO stage.Invoices (
	   [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]
)

SELECT [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]		
FROM [store].[DermaE_Invoices]


INSERT INTO stage.Invoices (
	   [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]
)

SELECT [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]		
FROM [store].[Think_Invoices]



INSERT INTO stage.Invoices (
	   [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]
)

SELECT [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]		
FROM [store].[Topiderm_Invoices]



INSERT INTO stage.Invoices (
	   [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]
)

SELECT [InvoiceID]
      ,[CustomerID]
      ,[ItemID]
	  ,[orig_ord_type]
      ,[ord_type]
      ,[ord_no]
      ,[entered_dt]
      ,[ord_dt]
      ,[oe_po_no]
      ,[cus_no]
      ,[bill_to_name]
      ,[cus_alt_adr_cd]
      ,[ship_to_name]
      ,[ship_via_cd]
      ,[ar_terms_cd]
      ,[ship_instruction_1]
      ,[ship_instruction_2]
      ,[slspsn_no]
      ,[tot_sls_amt]
      ,[tot_sls_disc]
      ,[tot_tax_amt]
      ,[tot_cost]
      ,[misc_amt]
      ,[frt_amt]
      ,[sls_tax_amt_1]
      ,[sls_tax_amt_2]
      ,[sls_tax_amt_3]
      ,[inv_no]
      ,[inv_dt]
      ,[tot_dollars]
      ,[bill_to_no]
      ,[ship_to_city]
      ,[ship_to_state]
      ,[ship_to_zip]
      ,[bill_to_city]
      ,[bill_to_state]
      ,[bill_to_zip]
      ,[line_seq_no]
      ,[item_no]
      ,[loc]
      ,[item_desc_1]
      ,[item_desc_2]
      ,[qty_ordered]
      ,[qty_to_ship]
      ,[unit_price]
      ,[discount_pct]
      ,[request_dt]
      ,[qty_bkord]
      ,[qty_return_to_stk]
      ,[unit_cost]
      ,[prod_cat]
      ,[user_def_fld_1]
      ,[user_def_fld_2]
      ,[user_def_fld_3]
      ,[user_def_fld_4]
      ,[user_def_fld_5]
      ,[sls_amt]
      ,[cost_amt]
      ,[Company]	= CASE WHEN	[prod_cat] = 'RPX' THEN 'Replenix' ELSE 'Topix' END
FROM [store].[Topix_Invoices]
GO